{"version":3,"sources":["configs/format.ts","plugins/ProjectSystem/services/common.ts","plugins/ProjectSystem/services/project.ts","plugins/ProjectSystem/components/ProjectsComboBox.tsx","plugins/ProjectSystem/common/commitHelper.ts","plugins/ProjectSystem/services/commit.ts","plugins/ProjectSystem/common/helper.ts","plugins/ProjectSystem/services/item.ts","plugins/ProjectSystem/services/resource.ts","plugins/ProjectSystem/pages/CbsReport.tsx","plugins/ProjectSystem/pages/EstimatorCommits.tsx","plugins/ProjectSystem/components/MaterialsComboBox.tsx","plugins/ProjectSystem/pages/Resources.tsx","plugins/ProjectSystem/routes/EstimatorRoutes.tsx"],"names":["format","formatDate","date","formatString","result","symbol","value","getDate","getMonth","getFullYear","getHours","getMinutes","map","f","replace","formatMoney","frac","numberFormat","Intl","NumberFormat","maximumFractionDigits","minimumFractionDigits","changeStatusEnum","CREATE","UPDATE","DELETE","versionNumberEnum","PACK","POST","branchEnum","PLANNER","DESIGNER","ESTIMATOR","SUPERVISOR","apiUrl","service","getAll","axios","get","projectCode","PROJECT_CODE_KEY","PROJECT_NAME_KEY","renderComboBoxOptions","projects","x","label","code","name","ProjectsComboBox","onChange","React","useState","setProjects","getProjects","a","projectService","useEffect","cacheProject","localStorage","getItem","getCache","required","options","optionLabel","getOptionSelected","o","v","project","setItem","setCache","getCommitterElements","data","e","pack","post","commitNumber","description","finish","level","start","status","Date","getCommitterClusters","note","filePath","getCommitterElementClusters","elementCode","clusterCode","quantity","getCommitterItems","serviceMasterCode","billCode","getCommitterResources","materialCode","getCommitterConfirmations","postingDate","getPlannerCommitData","elements","getDesignerCommitData","clusters","elementClusters","items","getEstimatorCommitData","resources","getSupervisorCommitData","confirmations","plannerTrackingChange","designerTrackingChange","estimatorTrackingChange","supervisorTrackingChange","plannerCommit","designerCommit","estimatorCommit","supervisorCommit","addPeriod","period","year","parseInt","toString","substr","helper","getRbsViewReport","periods","minPeriod","Math","min","maxPeriod","max","Array","from","Set","element","find","y","undefined","elementDescription","unit","getElements","item","materialGroup","matGroup","materialGroupDescription","getMatGroups","filter","g","material","getMaterials","m","total","subData","push","getDays","b","getTime","version","getCollective","getDistinct","create","model","edit","put","remove","models","addFromExcel","file","formData","FormData","append","headers","getCbsReport","useStyles","makeStyles","root","width","height","container","maxHeight","overflowY","maxWidth","overflowX","cell","fontSize","getPeriods","CbsReport","classes","dispatch","useDispatch","setProject","rbs","setRbs","handleRefresh","loadingActions","show","resourceService","alertActions","alertMessage","FETCH_FAILURE","hide","Paper","className","Grid","xs","style","padding","direction","spacing","alignItems","tooltip","variant","text","color","icon","onClick","filename","url","TableContainer","Table","stickyHeader","aria-label","size","TableHead","TableRow","TableCell","align","minWidth","whiteSpace","TableBody","Fragment","backgroundColor","fontWeight","fontStyle","paddingLeft","reduce","acc","val","index","getRowColor","colors","green","amber","red","EstimatorCommits","setModel","showForm","setShowForm","commitDescription","setCommitDescription","isApprover","setIsApprover","handleSubmit","header","branch","createdBy","createdByFullName","createdTime","number","detail","commitService","ACTION_SUCCESS","ACTION_FAILURE","checkIsApprover","userService","checkRolePermission","title","open","onClose","onSubmit","type","target","length","r","serviceMasterDescription","serviceMasterUnit","materialDescription","materialUnit","MATERIAL_CODE_KEY","MATERIAL_DESCRIPTION_KEY","MATERIAL_UNIT_KEY","MaterialsComboBox","serviceMasters","setData","getData","materialService","cache","initialState","isInclude","Resources","isEdit","setIsEdit","setMaterial","setItems","setResources","selectedList","setSelectedList","showAddExcelResult","setShowAddExcelResult","addExcelResult","setAddExcelResult","keyWord","setKeyWord","showConfirmDelete","setShowConfirmDelete","handleSubmitDelete","fetchResources","handleSubmitUploadForm","files","Promise","all","itemService","handleChange","event","parseFloat","versionNumber","handleSelect","Typography","s","i","md","isAdded","message","disabled","filesLimit","acceptedFiles","teal","cursor","handleOpenEditForm","colSpan","EstimatorRoutes","path","useRouteMatch","component"],"mappings":"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","file":"static/js/11.a82d5398.chunk.js","sourcesContent":["function formatDate(date: Date, formatString = 'dd/MM/yyyy'): string {\n  let result = formatString;\n\n  const format = [\n    {\n      symbol: 'dd',\n      value: date.getDate() < 10 ? `0${date.getDate()}` : date.getDate(),\n    },\n    {\n      symbol: 'MM',\n      value: date.getMonth() + 1 < 10 ? `0${date.getMonth() + 1}` : `${date.getMonth() + 1}`,\n    },\n    {\n      symbol: 'yyyy',\n      value: date.getFullYear(),\n    },\n    {\n      symbol: 'hh',\n      value: date.getHours() < 10 ? `0${date.getHours()}` : date.getHours(),\n    },\n    {\n      symbol: 'mm',\n      value: date.getMinutes() < 10 ? `0${date.getMinutes()}` : date.getMinutes(),\n    },\n  ];\n\n  format.map((f) => {\n    result = result.replace(f.symbol, f.value as string);\n    return f.symbol;\n  });\n\n  return result;\n}\n\nfunction formatMoney(value: number, frac = 0): string {\n  const numberFormat = new Intl.NumberFormat('vi-VN', { maximumFractionDigits: frac, minimumFractionDigits: frac });\n  return numberFormat.format(value);\n}\n\nconst format = {\n  formatDate,\n  formatMoney,\n};\n\nexport default format;\n","export const changeStatusEnum = {\n  CREATE: 1,\n  UPDATE: 2,\n  DELETE: 3,\n};\n\nexport const versionNumberEnum = {\n  PACK: -1,\n  POST: 0,\n}\n\nexport const branchEnum = {\n  PLANNER: 1,\n  DESIGNER: 2,\n  ESTIMATOR: 3,\n  SUPERVISOR: 4,\n}\n\nexport type TrackingChangeModel<T> = {\n  pack: T | null;\n  post: T | null;\n  status: number;\n};\n\nexport type AddFromExcelModel<T> = {\n  item: T;\n  isAdded: boolean;\n  message: string;\n};","import axios from 'axios';\n\nconst apiUrl = '/api/project-system/projects';\n\nexport type ProjectModel = {\n  code: string;\n  name: string;\n}\n\nfunction getAll(): Promise<ProjectModel[]> {\n  return axios.get(apiUrl);\n}\n\nfunction get(projectCode: string): Promise<ProjectModel> {\n  return axios.get(`${apiUrl}/${projectCode}`);\n}\n\nconst service = {\n  getAll,\n  get,\n};\n\nexport default service;\n","import React from 'react';\n\nimport {\n  ComboBox,\n} from '@nvdunginest/emis-mui';\n\nimport projectService, {\n  ProjectModel,\n} from '../services/project';\n\ntype ComboBoxType = ProjectModel & {\n  label: string;\n}\n\ntype Props = {\n  value: ProjectModel | null;\n  onChange: (value: ProjectModel) => void;\n}\n\nconst PROJECT_CODE_KEY = 'PROJECT_CODE_KEY';\nconst PROJECT_NAME_KEY = 'PROJECT_NAME_KEY';\n\nconst renderComboBoxOptions = (projects: ProjectModel[]): ComboBoxType[] => {\n  return projects.map(x => {\n    const result: ComboBoxType = {\n      ...x,\n      label: `[${x.code}]-${x.name}`,\n    }\n\n    return result;\n  })\n}\n\nconst getCache = (): ComboBoxType | null => {\n  const code = localStorage.getItem(PROJECT_CODE_KEY);\n  const name = localStorage.getItem(PROJECT_NAME_KEY);\n  if (code === null || name === null) {\n    return null;\n  }\n  else {\n    return {\n      code: code,\n      name: name,\n      label: `[${code}]-${name}`,\n    };\n  }\n}\n\nconst setCache = (project: ComboBoxType) => {\n  localStorage.setItem(PROJECT_CODE_KEY, project.code);\n  localStorage.setItem(PROJECT_NAME_KEY, project.name);\n}\n\nexport default function ProjectsComboBox({\n  value,\n  onChange,\n}: Props): JSX.Element {\n\n  const [projects, setProjects] = React.useState<ProjectModel[]>([]);\n\n  const getProjects = async () => {\n    try {\n      setProjects(await projectService.getAll());\n    }\n    catch {\n      setProjects([]);\n    }\n  }\n\n  const handleProjectChange = (value: ComboBoxType | null) => {\n    if (value !== null) {\n      onChange({\n        code: value.code,\n        name: value.name,\n      });\n      setCache(value);\n    }\n  }\n\n  React.useEffect(() => {\n    const cacheProject = getCache();\n    if (cacheProject !== null) {\n      onChange({\n        code: cacheProject.code,\n        name: cacheProject.name,\n      });\n    }\n    getProjects();\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <ComboBox\n      required\n      label=\"Dự án\"\n      options={renderComboBoxOptions(projects)}\n      optionLabel=\"label\"\n      value={value !== null ? { code: value.code, name: value.name, label: `[${value.code}]-${value.name}`, } : null}\n      getOptionSelected={(o, v) => o.code === v.code}\n      onChange={handleProjectChange}\n    />\n  );\n}\n","import {\n  changeStatusEnum,\n  TrackingChangeModel,\n} from '../services/common';\n\nimport {\n  PlannerCommit,\n  PlannerTrackingChangeModel,\n  DesignerCommit,\n  DesignerTrackingChangeModel,\n  EstimatorCommit,\n  EstimatorTrackingChangeModel,\n  SupervisorCommit,\n  SupervisorTrackingChangeModel,\n} from '../services/commit';\n\nimport {\n  ElementModel,\n  CommittedElementModel,\n} from '../services/element';\n\nimport {\n  ClusterViewModel,\n  CommittedClusterModel,\n} from '../services/cluster';\n\nimport {\n  ElementClusterViewModel,\n  CommittedElementClusterModel,\n} from '../services/elementCluster';\n\nimport {\n  ItemViewModel,\n  CommittedItemModel,\n} from '../services/item';\n\nimport {\n  ResourceViewModel,\n  CommittedResourceModel,\n} from '../services/resource';\n\nimport {\n  ConfirmationModel,\n  CommittedConfirmationModel,\n} from '../services/confirmation';\n\nconst getCommitterElements = (data: TrackingChangeModel<ElementModel>[]): CommittedElementModel[] => {\n  return data.map(e => {\n    if (e.pack === null && e.post !== null)\n      return {\n        code: e.post.code,\n        commitNumber: 0,\n        description: e.post.description,\n        finish: e.post.finish,\n        level: e.post.level,\n        projectCode: e.post.projectCode,\n        start: e.post.start,\n        status: changeStatusEnum.DELETE,\n      };\n\n    if (e.pack !== null && e.post === null)\n      return {\n        code: e.pack.code,\n        commitNumber: 0,\n        description: e.pack.description,\n        finish: e.pack.finish,\n        level: e.pack.level,\n        projectCode: e.pack.projectCode,\n        start: e.pack.start,\n        status: changeStatusEnum.CREATE,\n      };\n\n    if (e.pack !== null && e.post !== null)\n      return {\n        code: e.pack.code,\n        commitNumber: 0,\n        description: e.pack.description,\n        finish: e.pack.finish,\n        level: e.pack.level,\n        projectCode: e.pack.projectCode,\n        start: e.pack.start,\n        status: changeStatusEnum.UPDATE,\n      };\n\n    return {\n      code: '',\n      commitNumber: 0,\n      description: '',\n      finish: new Date(),\n      level: 1,\n      projectCode: '',\n      start: new Date(),\n      status: changeStatusEnum.UPDATE,\n    };\n  })\n}\n\nconst getCommitterClusters = (data: TrackingChangeModel<ClusterViewModel>[]): CommittedClusterModel[] => {\n  return data.map(e => {\n    if (e.pack === null && e.post !== null)\n      return {\n        code: e.post.code,\n        commitNumber: 0,\n        description: e.post.description,\n        projectCode: e.post.projectCode,\n        note: e.post.note,\n        filePath: e.post.filePath,\n        status: changeStatusEnum.DELETE,\n      };\n\n    if (e.pack !== null && e.post === null)\n      return {\n        code: e.pack.code,\n        commitNumber: 0,\n        description: e.pack.description,\n        projectCode: e.pack.projectCode,\n        note: e.pack.note,\n        filePath: e.pack.filePath,\n        status: changeStatusEnum.CREATE,\n      };\n\n    if (e.pack !== null && e.post !== null)\n      return {\n        code: e.pack.code,\n        commitNumber: 0,\n        description: e.pack.description,\n        projectCode: e.pack.projectCode,\n        note: e.pack.note,\n        filePath: e.pack.filePath,\n        status: changeStatusEnum.UPDATE,\n      };\n\n    return {\n      code: '',\n      commitNumber: 0,\n      description: '',\n      projectCode: '',\n      note: '',\n      filePath: '',\n      status: changeStatusEnum.UPDATE,\n    };\n  })\n}\n\nconst getCommitterElementClusters = (data: TrackingChangeModel<ElementClusterViewModel>[]): CommittedElementClusterModel[] => {\n  return data.map(e => {\n    if (e.pack === null && e.post !== null)\n      return {\n        elementCode: e.post.elementCode,\n        clusterCode: e.post.clusterCode,\n        quantity: e.post.quantity,\n        commitNumber: 0,\n        projectCode: e.post.projectCode,\n        status: changeStatusEnum.DELETE,\n      };\n\n    if (e.pack !== null && e.post === null)\n      return {\n        elementCode: e.pack.elementCode,\n        clusterCode: e.pack.clusterCode,\n        quantity: e.pack.quantity,\n        commitNumber: 0,\n        projectCode: e.pack.projectCode,\n        status: changeStatusEnum.CREATE,\n      };\n\n    if (e.pack !== null && e.post !== null)\n      return {\n        elementCode: e.pack.elementCode,\n        clusterCode: e.pack.clusterCode,\n        quantity: e.pack.quantity,\n        commitNumber: 0,\n        projectCode: e.pack.projectCode,\n        status: changeStatusEnum.UPDATE,\n      };\n\n    return {\n      elementCode: '',\n      clusterCode: '',\n      quantity: 1,\n      commitNumber: 0,\n      projectCode: '',\n      status: changeStatusEnum.UPDATE,\n    };\n  })\n}\n\nconst getCommitterItems = (data: TrackingChangeModel<ItemViewModel>[]): CommittedItemModel[] => {\n  return data.map(e => {\n    if (e.pack === null && e.post !== null)\n      return {\n        serviceMasterCode: e.post.serviceMasterCode,\n        clusterCode: e.post.clusterCode,\n        billCode: e.post.billCode,\n        quantity: e.post.quantity,\n        commitNumber: 0,\n        projectCode: e.post.projectCode,\n        status: changeStatusEnum.DELETE,\n      };\n\n    if (e.pack !== null && e.post === null)\n      return {\n        serviceMasterCode: e.pack.serviceMasterCode,\n        clusterCode: e.pack.clusterCode,\n        billCode: e.pack.billCode,\n        quantity: e.pack.quantity,\n        commitNumber: 0,\n        projectCode: e.pack.projectCode,\n        status: changeStatusEnum.CREATE,\n      };\n\n    if (e.pack !== null && e.post !== null)\n      return {\n        serviceMasterCode: e.pack.serviceMasterCode,\n        clusterCode: e.pack.clusterCode,\n        billCode: e.pack.billCode,\n        quantity: e.pack.quantity,\n        commitNumber: 0,\n        projectCode: e.pack.projectCode,\n        status: changeStatusEnum.UPDATE,\n      };\n\n    return {\n      serviceMasterCode: '',\n      clusterCode: '',\n      billCode: '',\n      quantity: 1,\n      commitNumber: 0,\n      projectCode: '',\n      status: changeStatusEnum.UPDATE,\n    };\n  })\n}\n\nconst getCommitterResources = (data: TrackingChangeModel<ResourceViewModel>[]): CommittedResourceModel[] => {\n  return data.map(e => {\n    if (e.pack === null && e.post !== null)\n      return {\n        serviceMasterCode: e.post.serviceMasterCode,\n        materialCode: e.post.materialCode,\n        quantity: e.post.quantity,\n        commitNumber: 0,\n        projectCode: e.post.projectCode,\n        status: changeStatusEnum.DELETE,\n      };\n\n    if (e.pack !== null && e.post === null)\n      return {\n        serviceMasterCode: e.pack.serviceMasterCode,\n        materialCode: e.pack.materialCode,\n        quantity: e.pack.quantity,\n        commitNumber: 0,\n        projectCode: e.pack.projectCode,\n        status: changeStatusEnum.CREATE,\n      };\n\n    if (e.pack !== null && e.post !== null)\n      return {\n        serviceMasterCode: e.pack.serviceMasterCode,\n        materialCode: e.pack.materialCode,\n        quantity: e.pack.quantity,\n        commitNumber: 0,\n        projectCode: e.pack.projectCode,\n        status: changeStatusEnum.UPDATE,\n      };\n\n    return {\n      serviceMasterCode: '',\n      materialCode: '',\n      quantity: 1,\n      commitNumber: 0,\n      projectCode: '',\n      status: changeStatusEnum.UPDATE,\n    };\n  })\n}\n\nconst getCommitterConfirmations = (data: TrackingChangeModel<ConfirmationModel>[]): CommittedConfirmationModel[] => {\n  return data.map(e => {\n    if (e.pack === null && e.post !== null)\n      return {\n        elementCode: e.post.elementCode,\n        postingDate: e.post.postingDate,\n        commitNumber: 0,\n        projectCode: e.post.projectCode,\n        status: changeStatusEnum.DELETE,\n      };\n\n    if (e.pack !== null && e.post === null)\n      return {\n        elementCode: e.pack.elementCode,\n        postingDate: e.pack.postingDate,\n        commitNumber: 0,\n        projectCode: e.pack.projectCode,\n        status: changeStatusEnum.CREATE,\n      };\n\n    if (e.pack !== null && e.post !== null)\n      return {\n        elementCode: e.pack.elementCode,\n        postingDate: e.pack.postingDate,\n        commitNumber: 0,\n        projectCode: e.pack.projectCode,\n        status: changeStatusEnum.UPDATE,\n      };\n\n    return {\n      elementCode: '',\n      postingDate: new Date(),\n      commitNumber: 0,\n      projectCode: '',\n      status: changeStatusEnum.UPDATE,\n    };\n  })\n}\n\nexport const getPlannerCommitData = (data: PlannerTrackingChangeModel): PlannerCommit => {\n  return {\n    elements: getCommitterElements(data.elements),\n  }\n}\n\nexport const getDesignerCommitData = (data: DesignerTrackingChangeModel): DesignerCommit => {\n  return {\n    clusters: getCommitterClusters(data.clusters),\n    elementClusters: getCommitterElementClusters(data.elementClusters),\n    items: getCommitterItems(data.items),\n  }\n}\n\nexport const getEstimatorCommitData = (data: EstimatorTrackingChangeModel): EstimatorCommit => {\n  return {\n    resources: getCommitterResources(data.resources),\n  }\n}\n\nexport const getSupervisorCommitData = (data: SupervisorTrackingChangeModel): SupervisorCommit => {\n  return {\n    confirmations: getCommitterConfirmations(data.confirmations),\n  }\n}","import axios from 'axios';\nimport {\n  TrackingChangeModel,\n} from './common';\n\nimport {\n  ElementModel,\n  CommittedElementModel,\n} from './element';\n\nimport {\n  ClusterViewModel,\n  CommittedClusterModel,\n} from './cluster';\n\nimport {\n  ElementClusterViewModel,\n  CommittedElementClusterModel,\n} from './elementCluster';\n\nimport {\n  ItemViewModel,\n  CommittedItemModel,\n} from './item';\n\nimport {\n  ResourceViewModel,\n  CommittedResourceModel,\n} from './resource';\n\nimport {\n  ConfirmationModel,\n  CommittedConfirmationModel,\n} from '../services/confirmation';\n\nconst apiUrl = '/api/project-system/commits';\n\nexport type PlannerTrackingChangeModel = {\n  elements: TrackingChangeModel<ElementModel>[];\n}\n\nexport type DesignerTrackingChangeModel = {\n  clusters: TrackingChangeModel<ClusterViewModel>[];\n  elementClusters: TrackingChangeModel<ElementClusterViewModel>[];\n  items: TrackingChangeModel<ItemViewModel>[];\n}\n\nexport type EstimatorTrackingChangeModel = {\n  resources: TrackingChangeModel<ResourceViewModel>[];\n}\n\nexport type SupervisorTrackingChangeModel = {\n  confirmations: TrackingChangeModel<ConfirmationModel>[];\n}\n\nexport type Commit = {\n  number: number;\n  projectCode: string;\n  branch: number;\n  description: string;\n  createdBy: string;\n  createdByFullName: string;\n  createdTime: Date;\n}\n\nexport type PlannerCommit = {\n  elements: CommittedElementModel[];\n}\n\nexport type DesignerCommit = {\n  clusters: CommittedClusterModel[];\n  elementClusters: CommittedElementClusterModel[];\n  items: CommittedItemModel[];\n}\n\nexport type EstimatorCommit = {\n  resources: CommittedResourceModel[];\n}\n\nexport type SupervisorCommit = {\n  confirmations: CommittedConfirmationModel[];\n}\n\nexport type AddCommitModel<T> = {\n  header: Commit;\n  detail: T;\n}\n\nfunction plannerTrackingChange(projectCode: string): Promise<PlannerTrackingChangeModel> {\n  return axios.get(`${apiUrl}/planner-tracking-change?projectCode=${projectCode}`);\n}\n\nfunction designerTrackingChange(projectCode: string): Promise<DesignerTrackingChangeModel> {\n  return axios.get(`${apiUrl}/designer-tracking-change?projectCode=${projectCode}`);\n}\n\nfunction estimatorTrackingChange(projectCode: string): Promise<EstimatorTrackingChangeModel> {\n  return axios.get(`${apiUrl}/estimator-tracking-change?projectCode=${projectCode}`);\n}\n\nfunction supervisorTrackingChange(projectCode: string): Promise<SupervisorTrackingChangeModel> {\n  return axios.get(`${apiUrl}/supervisor-tracking-change?projectCode=${projectCode}`);\n}\n\nfunction plannerCommit(projectCode: string, data: AddCommitModel<PlannerCommit>): Promise<unknown> {\n  return axios.post(`${apiUrl}/planner-commit?projectCode=${projectCode}`, data);\n}\n\nfunction designerCommit(projectCode: string, data: AddCommitModel<DesignerCommit>): Promise<unknown> {\n  return axios.post(`${apiUrl}/designer-commit?projectCode=${projectCode}`, data);\n}\n\nfunction estimatorCommit(projectCode: string, data: AddCommitModel<EstimatorCommit>): Promise<unknown> {\n  return axios.post(`${apiUrl}/estimator-commit?projectCode=${projectCode}`, data);\n}\n\nfunction supervisorCommit(projectCode: string, data: AddCommitModel<SupervisorCommit>): Promise<unknown> {\n  return axios.post(`${apiUrl}/supervisor-commit?projectCode=${projectCode}`, data);\n}\n\nconst service = {\n  plannerTrackingChange,\n  designerTrackingChange,\n  estimatorTrackingChange,\n  supervisorTrackingChange,\n  plannerCommit,\n  designerCommit,\n  estimatorCommit,\n  supervisorCommit,\n};\n\nexport default service;\n","import {\n  CbsModel,\n} from '../services/resource';\n\nexport type RbsItem = {\n  item: Item;\n  total: number;\n  data: number[];\n}\n\nexport type MatGroup = {\n  item: Item;\n  data: RbsItem[];\n}\n\nexport type ElementLv3Item = {\n  item: Item;\n  data: MatGroup[];\n}\n\nexport type Item = {\n  code: string;\n  description: string;\n  unit: string;\n}\n\nconst getElements = (data: CbsModel[]): Item[] => {\n  const codes = Array.from(new Set(data.map(x => x.elementCode)));\n  return codes.map(x => {\n    const element = data.find(y => y.elementCode === x);\n    return ({\n      code: x,\n      description: element !== undefined ? element.elementDescription : '',\n      unit: '',\n    })\n  });\n}\n\nconst getMatGroups = (data: CbsModel[]): Item[] => {\n  const codes = Array.from(new Set(data.map(x => x.materialGroup)));\n  return codes.map(x => {\n    const matGroup = data.find(y => y.materialGroup === x);\n    return ({\n      code: x,\n      description: matGroup !== undefined ? matGroup.materialGroupDescription : '',\n      unit: '',\n    })\n  });\n}\n\nconst getMaterials = (data: CbsModel[]): Item[] => {\n  const codes = Array.from(new Set(data.map(x => x.materialCode)));\n  return codes.map(x => {\n    const material = data.find(y => y.materialCode === x);\n    return ({\n      code: x,\n      description: material !== undefined ? material.description : '',\n      unit: material !== undefined ? material.unit : '',\n    })\n  });\n}\n\nconst addPeriod = (period: number): number => {\n  const year = parseInt(period.toString().substr(0, 4));\n  const month = parseInt(period.toString().substr(4, 2));\n\n  if (month < 12) return period + 1;\n  else return (year + 1) * 100 + 1;\n}\n\nconst getRbsViewReport = (data: CbsModel[]): ElementLv3Item[] => {\n  const periods = data.map(x => x.period);\n  const minPeriod = Math.min(...periods);\n  const maxPeriod = Math.max(...periods);\n\n  const result: ElementLv3Item[] = [];\n  const elements = getElements(data);\n  elements.map(e => {\n    const element: ElementLv3Item = {\n      item: e,\n      data: [],\n    };\n    const matGroups = getMatGroups(data.filter(x => x.elementCode === e.code));\n    matGroups.map(g => {\n      const matGroup: MatGroup = {\n        item: g,\n        data: [],\n      };\n      const materials = getMaterials(data.filter(x => x.elementCode === e.code && x.materialGroup === g.code));\n      materials.map(m => {\n        const material: RbsItem = {\n          item: m,\n          total: 0,\n          data: [],\n        };\n        const subData = data.filter(x => x.elementCode === e.code && x.materialGroup === g.code && x.materialCode === m.code);\n        let period = minPeriod;\n        while (period <= maxPeriod) {\n          const item = subData.find(x => x.period === period);\n          if (item !== undefined) {\n            material.data.push(item.quantity);\n          }\n          else {\n            material.data.push(0);\n          }\n\n          period = addPeriod(period);\n        }\n\n        matGroup.data.push(material);\n        return true;\n      })\n\n      element.data.push(matGroup);\n      return true;\n    })\n\n    result.push(element);\n    return true;\n  });\n\n  return result;\n}\n\nconst getDays = (a: Date, b: Date): number => (b.getTime() - a.getTime()) / 1000 / 86400 + 1;\n\nconst helper = {\n  getRbsViewReport,\n  addPeriod,\n  getDays,\n};\n\nexport default helper;","import axios from 'axios';\n\nimport {\n  AddFromExcelModel,\n} from './common';\n\nconst apiUrl = '/api/project-system/items';\n\nexport type ItemBase = {\n  clusterCode: string;\n  serviceMasterCode: string;\n  billCode: string;\n  quantity: number;\n  projectCode: string;\n}\n\nexport type ItemModel = ItemBase & {\n  versionNumber: number;\n}\n\nexport type CommittedItemModel = ItemBase & {\n  commitNumber: number;\n  status: number;\n}\n\nexport type ItemViewModel = ItemModel & {\n  serviceMasterDescription: string;\n  serviceMasterUnit: string;\n  clusterDescription: string;\n}\n\nexport type ItemRemoveModel = {\n  clusterCode: string;\n  serviceMasterCode: string;\n}\n\nfunction getAll(projectCode: string, version: number): Promise<ItemViewModel[]> {\n  return axios.get(`${apiUrl}?projectCode=${projectCode}&version=${version}`);\n}\n\nfunction getDistinct(projectCode: string, version: number): Promise<ItemViewModel[]> {\n  return axios.get(`${apiUrl}/get-distinct?projectCode=${projectCode}&version=${version}`);\n}\n\nfunction getCollective(projectCode: string, version: number): Promise<ItemViewModel[]> {\n  return axios.get(`${apiUrl}/get-collective?projectCode=${projectCode}&version=${version}`);\n}\n\nfunction create(projectCode: string, model: ItemModel): Promise<unknown> {\n  return axios.post(`${apiUrl}?projectCode=${projectCode}`, model);\n}\n\nfunction edit(projectCode: string, serviceMasterCode: string, clusterCode: string, model: ItemModel): Promise<unknown> {\n  return axios.put(`${apiUrl}?projectCode=${projectCode}&serviceMasterCode=${serviceMasterCode}&clusterCode=${clusterCode}`, model);\n}\n\nfunction remove(projectCode: string, models: ItemRemoveModel[]): Promise<unknown> {\n  return axios.post(`${apiUrl}/delete?projectCode=${projectCode}`, models);\n}\n\nfunction addFromExcel(projectCode: string, file: File): Promise<AddFromExcelModel<ItemModel>[]> {\n  const formData = new FormData();\n  formData.append('files', file, file.name);\n\n  return axios.post(\n    `${apiUrl}/addFromExcel?projectCode=${projectCode}`,\n    formData,\n    {\n      headers: {\n        'Content-Type': 'multipart/form-data',\n      },\n    },\n  );\n}\n\nconst service = {\n  getAll,\n  getCollective,\n  getDistinct,\n  create,\n  edit,\n  remove,\n  addFromExcel,\n};\n\nexport default service;\n","import axios from 'axios';\n\nimport {\n  AddFromExcelModel,\n} from './common';\n\nconst apiUrl = '/api/project-system/resources';\n\nexport type ResourceBase = {\n  projectCode: string;\n  serviceMasterCode: string;\n  materialCode: string;\n  quantity: number;\n}\n\nexport type ResourceModel = ResourceBase & {\n  versionNumber: number;\n}\n\nexport type CommittedResourceModel = ResourceBase & {\n  commitNumber: number;\n  status: number;\n}\n\nexport type ResourceViewModel = ResourceModel & {\n  serviceMasterDescription: string;\n  serviceMasterUnit: string;\n  materialDescription: string;\n  materialUnit: string;\n}\n\nexport type CbsModel = {\n  elementCode: string;\n  elementDescription: string;\n  period: number;\n  materialGroup: string;\n  materialGroupDescription: string;\n  materialCode: string;\n  description: string;\n  unit: string;\n  quantity: number;\n}\n\nexport type ResourceRemoveModel = {\n  serviceMasterCode: string;\n  materialCode: string;\n}\n\nfunction getAll(projectCode: string, version: number): Promise<ResourceViewModel[]> {\n  return axios.get(`${apiUrl}?projectCode=${projectCode}&version=${version}`);\n}\n\nfunction getCbsReport(projectCode: string): Promise<CbsModel[]> {\n  return axios.get(`${apiUrl}/get-cbs-report?projectCode=${projectCode}`);\n}\n\nfunction create(projectCode: string, model: ResourceModel): Promise<unknown> {\n  return axios.post(`${apiUrl}?projectCode=${projectCode}`, model);\n}\n\nfunction edit(projectCode: string, serviceMasterCode: string, materialCode: string, model: ResourceModel): Promise<unknown> {\n  return axios.put(`${apiUrl}?projectCode=${projectCode}&serviceMasterCode=${serviceMasterCode}&materialCode=${materialCode}`, model);\n}\n\nfunction remove(projectCode: string, models: ResourceRemoveModel[]): Promise<unknown> {\n  return axios.post(`${apiUrl}/delete?projectCode=${projectCode}`, models);\n}\n\nfunction addFromExcel(projectCode: string, file: File): Promise<AddFromExcelModel<ResourceModel>[]> {\n  const formData = new FormData();\n  formData.append('files', file, file.name);\n\n  return axios.post(\n    `${apiUrl}/addFromExcel?projectCode=${projectCode}`,\n    formData,\n    {\n      headers: {\n        'Content-Type': 'multipart/form-data',\n      },\n    },\n  );\n}\n\nconst service = {\n  getAll,\n  getCbsReport,\n  create,\n  edit,\n  remove,\n  addFromExcel,\n};\n\nexport default service;\n","import React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { makeStyles } from '@material-ui/core/styles';\nimport {\n\tPaper,\n\tTable,\n\tTableBody,\n\tTableCell,\n\tTableContainer,\n\tTableHead,\n\tTableRow,\n\tGrid,\n} from '@material-ui/core';\n\nimport {\n\tIconButton,\n\tDownloadButton,\n} from '@nvdunginest/emis-mui';\n\nimport format from '../../../configs/format';\n\nimport {\n\tAppDispatch,\n\talertActions,\n\talertMessage,\n\tloadingActions,\n} from '../../../core';\n\nimport ProjectComboBox from '../components/ProjectsComboBox';\n\nimport {\n\tProjectModel,\n} from '../services/project';\n\nimport resourceService, {\n\tCbsModel,\n} from '../services/resource';\n\nimport helper from '../common/helper';\n\nconst useStyles = makeStyles({\n\troot: {\n\t\twidth: '100%',\n\t\theight: '100%',\n\t},\n\tcontainer: {\n\t\tmaxHeight: 'calc(100% - 85px)',\n\t\toverflowY: 'scroll',\n\t\tmaxWidth: '100%',\n\t\toverflowX: 'auto',\n\t},\n\tcell: {\n\t\tfontSize: '0.75rem',\n\t},\n});\n\nconst getPeriods = (data: CbsModel[]): string[] => {\n\tconst periods = data.map(x => x.period);\n\tconst minPeriod = Math.min(...periods);\n\tconst maxPeriod = Math.max(...periods);\n\n\tconst result: string[] = [];\n\tlet period = minPeriod;\n\twhile (period <= maxPeriod) {\n\t\tresult.push(`${period.toString().substr(4, 2)}/${period.toString().substr(0, 4)}`)\n\n\t\tperiod = helper.addPeriod(period);\n\t}\n\n\treturn result;\n}\n\nexport default function CbsReport(): JSX.Element {\n\tconst classes = useStyles();\n\tconst dispatch: AppDispatch = useDispatch();\n\n\tconst [project, setProject] = React.useState<ProjectModel | null>(null);\n\n\tconst [rbs, setRbs] = React.useState<CbsModel[]>([]);\n\n\tconst handleProjectChange = (value: ProjectModel) => {\n\t\tsetProject(value);\n\t}\n\n\tconst handleRefresh = async () => {\n\t\tdispatch(loadingActions.show());\n\t\tif (project !== null) {\n\t\t\ttry {\n\t\t\t\tsetRbs(await resourceService.getCbsReport(project.code));\n\t\t\t}\n\t\t\tcatch {\n\t\t\t\tsetRbs([]);\n\t\t\t\tdispatch(alertActions.show(alertMessage.FETCH_FAILURE, 'error'));\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tsetRbs([]);\n\t\t}\n\t\tdispatch(loadingActions.hide());\n\t}\n\n\tReact.useEffect(() => {\n\t\thandleRefresh();\n\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [project]);\n\n\treturn (\n\t\t<Paper className={classes.root}>\n\t\t\t<Grid container>\n\t\t\t\t<Grid\n\t\t\t\t\tcontainer\n\t\t\t\t\titem xs={12}\n\t\t\t\t\tstyle={{ padding: '8px' }}\n\t\t\t\t\tdirection=\"row\"\n\t\t\t\t\tspacing={1}\n\t\t\t\t\talignItems=\"flex-end\"\n\t\t\t\t>\n\t\t\t\t\t<Grid item xs={6}>\n\t\t\t\t\t\t<ProjectComboBox\n\t\t\t\t\t\t\tvalue={project}\n\t\t\t\t\t\t\tonChange={handleProjectChange}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Grid>\n\t\t\t\t\t{project !== null && (\n\t\t\t\t\t\t<Grid container spacing={1} item xs={6}>\n\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\ttooltip=\"Làm mới\"\n\t\t\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\t\t\ttext=\"Làm mới\"\n\t\t\t\t\t\t\t\t\tcolor=\"success\"\n\t\t\t\t\t\t\t\t\ticon=\"sync-alt\"\n\t\t\t\t\t\t\t\t\tonClick={handleRefresh}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t<DownloadButton\n\t\t\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\t\t\tlabel=\"Network Activity\"\n\t\t\t\t\t\t\t\t\tfilename={`${project.code}_Network-activity.xlsx`}\n\t\t\t\t\t\t\t\t\turl={`/api/project-system/resources/get-network-activity-excel?projectCode=${project.code}`}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t<DownloadButton\n\t\t\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\t\t\tlabel=\"Material Component\"\n\t\t\t\t\t\t\t\t\tfilename={`${project.code}_Material-component.xlsx`}\n\t\t\t\t\t\t\t\t\turl={`/api/project-system/resources/get-material-component-excel?projectCode=${project.code}`}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t<DownloadButton\n\t\t\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\t\t\tlabel=\"Budget\"\n\t\t\t\t\t\t\t\t\tfilename={`${project.code}_Budget.xlsx`}\n\t\t\t\t\t\t\t\t\turl={`/api/project-system/resources/get-budget-excel?projectCode=${project.code}`}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t</Grid>\n\t\t\t\t\t)}\n\t\t\t\t</Grid>\n\t\t\t</Grid>\n\t\t\t<TableContainer className={classes.container}>\n\t\t\t\t<Table stickyHeader aria-label=\"sticky table\" size=\"small\">\n\t\t\t\t\t<TableHead>\n\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\talign=\"left\"\n\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\tstyle={{ minWidth: '20%', whiteSpace: 'nowrap' }}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tMã vật tư\n\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\talign=\"left\"\n\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\tstyle={{ minWidth: '40%', whiteSpace: 'nowrap' }}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tDiễn giải\n\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\talign=\"center\"\n\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\tstyle={{ minWidth: '20%', whiteSpace: 'nowrap' }}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tĐơn vị\n\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\talign=\"right\"\n\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\tstyle={{ minWidth: '20%', whiteSpace: 'nowrap' }}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tTổng cộng\n\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t{getPeriods(rbs).map(x => (\n\t\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\t\tkey={x}\n\t\t\t\t\t\t\t\t\talign=\"right\"\n\t\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\t\tstyle={{ minWidth: '20%', whiteSpace: 'nowrap' }}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{x}\n\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t</TableHead>\n\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t{helper.getRbsViewReport(rbs).map(e => (\n\t\t\t\t\t\t\t<React.Fragment key={e.item.code}>\n\t\t\t\t\t\t\t\t<TableRow style={{ backgroundColor: 'aqua' }}>\n\t\t\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\t\t\talign=\"left\"\n\t\t\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\t\t\tstyle={{ minWidth: '20%', fontWeight: 'bold', whiteSpace: 'nowrap' }}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{e.item.code}\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\t\t\talign=\"left\"\n\t\t\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\t\t\tstyle={{ minWidth: '40%', fontWeight: 'bold', whiteSpace: 'nowrap' }}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{e.item.description}\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell />\n\t\t\t\t\t\t\t\t\t<TableCell />\n\t\t\t\t\t\t\t\t\t{getPeriods(rbs).map(x => (\n\t\t\t\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\t\t\t\tkey={`${x}-${e.item.code}`}\n\t\t\t\t\t\t\t\t\t\t\talign=\"right\"\n\t\t\t\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\t\t\t\tstyle={{ minWidth: '20%', whiteSpace: 'nowrap' }}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t{e.data.map(g => (\n\t\t\t\t\t\t\t\t\t<React.Fragment key={`${e.item.code}.${g.item.code}`}>\n\t\t\t\t\t\t\t\t\t\t<TableRow style={{ backgroundColor: 'aquamarine' }}>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\t\t\t\t\talign=\"left\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ minWidth: '20%', fontWeight: 'bold', fontStyle: 'italic', paddingLeft: '32px', whiteSpace: 'nowrap' }}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t{`${e.item.code}.${g.item.code}`}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\t\t\t\t\talign=\"left\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ minWidth: '40%', fontWeight: 'bold', fontStyle: 'italic', paddingLeft: '32px', whiteSpace: 'nowrap' }}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t{g.item.description}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell />\n\t\t\t\t\t\t\t\t\t\t\t<TableCell />\n\t\t\t\t\t\t\t\t\t\t\t{getPeriods(rbs).map(x => (\n\t\t\t\t\t\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={`${x}-${e.item.code}-${g.item.code}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\talign=\"right\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ minWidth: '20%', whiteSpace: 'nowrap' }}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t\t{g.data.map(m => (\n\t\t\t\t\t\t\t\t\t\t\t<React.Fragment key={`${e.item.code}.${g.item.code}.${m.item.code}`}>\n\t\t\t\t\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talign=\"left\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ minWidth: '20%', fontStyle: 'italic', paddingLeft: '48px', whiteSpace: 'nowrap' }}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{m.item.code}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talign=\"left\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ minWidth: '40%', fontStyle: 'italic', paddingLeft: '48px', whiteSpace: 'nowrap' }}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{m.item.description}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talign=\"center\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ minWidth: '20%', fontStyle: 'italic', whiteSpace: 'nowrap' }}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{m.item.unit}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talign=\"right\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ minWidth: '20%', whiteSpace: 'nowrap' }}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{format.formatMoney(m.data.reduce((acc, val) => acc + val, 0), 3)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{m.data.map((x, index) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={`${e.item.code}.${g.item.code}.${m.item.code}.${index}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talign=\"right\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ minWidth: '20%', whiteSpace: 'nowrap' }}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{format.formatMoney(x, 3)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t\t\t</React.Fragment>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</React.Fragment>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</React.Fragment>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</TableBody>\n\t\t\t\t</Table>\n\t\t\t</TableContainer>\n\t\t</Paper >\n\t);\n}\n","import React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { makeStyles } from '@material-ui/core/styles';\nimport {\n\tPaper,\n\tTable,\n\tTableBody,\n\tTableCell,\n\tTableContainer,\n\tTableHead,\n\tTableRow,\n\tGrid,\n\tcolors,\n} from '@material-ui/core';\nimport {\n\tFormDialog,\n\tTextField,\n\tIconButton,\n} from '@nvdunginest/emis-mui';\n\nimport {\n\tAppDispatch,\n\talertActions,\n\talertMessage,\n\tloadingActions,\n} from '../../../core';\n\nimport format from '../../../configs/format';\n\nimport ProjectComboBox from '../components/ProjectsComboBox';\n\nimport { getEstimatorCommitData } from '../common/commitHelper';\n\nimport {\n\tbranchEnum,\n} from '../services/common';\n\nimport userService from '../services/user';\n\nimport {\n\tProjectModel,\n} from '../services/project';\n\nimport commitService, {\n\tAddCommitModel,\n\tEstimatorCommit,\n\tEstimatorTrackingChangeModel,\n} from '../services/commit';\n\nconst useStyles = makeStyles({\n\troot: {\n\t\twidth: '100%',\n\t\theight: '100%',\n\t},\n\tcontainer: {\n\t\tmaxHeight: 'calc(100% - 85px)',\n\t\toverflowY: 'scroll',\n\t},\n});\n\nconst getRowColor = (status: number): string => {\n\tswitch (status) {\n\t\tcase 1: return colors.green[500];\n\t\tcase 2: return colors.amber[500];\n\t\tdefault: return colors.red[500];\n\t}\n}\n\nexport default function EstimatorCommits(): JSX.Element {\n\tconst classes = useStyles();\n\tconst dispatch: AppDispatch = useDispatch();\n\n\tconst [project, setProject] = React.useState<ProjectModel | null>(null);\n\n\tconst [model, setModel] = React.useState<EstimatorTrackingChangeModel>({\n\t\tresources: [],\n\t});\n\tconst [showForm, setShowForm] = React.useState(false);\n\tconst [commitDescription, setCommitDescription] = React.useState<string>('');\n\n\tconst [isApprover, setIsApprover] = React.useState(false);\n\n\tconst handleCloseForm = () => {\n\t\tsetShowForm(false);\n\t};\n\n\tconst handleOpenForm = () => {\n\t\tsetCommitDescription('');\n\t\tsetShowForm(true);\n\t};\n\n\tconst handleSubmit = async () => {\n\t\tsetShowForm(false);\n\t\tdispatch(loadingActions.show());\n\t\ttry {\n\t\t\tconst data: AddCommitModel<EstimatorCommit> = {\n\t\t\t\theader: {\n\t\t\t\t\tbranch: branchEnum.ESTIMATOR,\n\t\t\t\t\tcreatedBy: '',\n\t\t\t\t\tcreatedByFullName: '',\n\t\t\t\t\tcreatedTime: new Date(),\n\t\t\t\t\tdescription: commitDescription,\n\t\t\t\t\tnumber: 0,\n\t\t\t\t\tprojectCode: project !== null ? project.code : '',\n\t\t\t\t},\n\t\t\t\tdetail: getEstimatorCommitData(model),\n\t\t\t}\n\n\t\t\tif (project !== null) {\n\t\t\t\tawait commitService.estimatorCommit(project.code, data);\n\t\t\t}\n\n\t\t\tdispatch(alertActions.show(alertMessage.ACTION_SUCCESS, 'success'));\n\t\t\thandleRefresh();\n\t\t}\n\t\tcatch {\n\t\t\tdispatch(alertActions.show(alertMessage.ACTION_FAILURE, 'error'));\n\t\t\tdispatch(loadingActions.hide());\n\t\t}\n\t};\n\n\tconst handleProjectChange = (value: ProjectModel) => {\n\t\tsetProject(value);\n\t};\n\n\tconst handleRefresh = async () => {\n\t\tif (project !== null) {\n\t\t\tdispatch(loadingActions.show());\n\t\t\ttry {\n\t\t\t\tsetModel(await commitService.estimatorTrackingChange(project.code));\n\t\t\t}\n\t\t\tcatch {\n\t\t\t\tsetModel({ resources: [] });\n\t\t\t\tdispatch(alertActions.show(alertMessage.FETCH_FAILURE, 'error'));\n\t\t\t}\n\t\t\tdispatch(loadingActions.hide());\n\t\t}\n\t\telse {\n\t\t\tsetModel({ resources: [] });\n\t\t}\n\t}\n\n\tconst checkIsApprover = async () => {\n\t\ttry {\n\t\t\tsetIsApprover(await userService.checkRolePermission('APPROVER_ESTIMATOR_ROLE'));\n\t\t}\n\t\tcatch {\n\t\t\tsetIsApprover(false);\n\t\t}\n\t}\n\n\tReact.useEffect(() => {\n\t\thandleRefresh();\n\t\tcheckIsApprover();\n\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [project]);\n\n\treturn (\n\t\t<>\n\t\t\t<FormDialog\n\t\t\t\ttitle=\"Cập nhật thay đổi lên server\"\n\t\t\t\topen={showForm}\n\t\t\t\tonClose={handleCloseForm}\n\t\t\t\tonSubmit={handleSubmit}\n\t\t\t>\n\t\t\t\t<Grid container spacing={1}>\n\t\t\t\t\t<Grid item xs={12}>\n\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\tname=\"commitDescription\"\n\t\t\t\t\t\t\tlabel=\"Mô tả nội dung cập nhật\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\tvalue={commitDescription}\n\t\t\t\t\t\t\tonChange={(e) => { setCommitDescription(e.target.value); }}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Grid>\n\t\t\t\t</Grid>\n\t\t\t</FormDialog>\n\t\t\t<Paper className={classes.root}>\n\t\t\t\t<Grid container>\n\t\t\t\t\t<Grid\n\t\t\t\t\t\tcontainer\n\t\t\t\t\t\titem xs={12}\n\t\t\t\t\t\tstyle={{ padding: '8px' }}\n\t\t\t\t\t\tdirection=\"row\"\n\t\t\t\t\t\tspacing={1}\n\t\t\t\t\t\talignItems=\"flex-end\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Grid item xs={6}>\n\t\t\t\t\t\t\t<ProjectComboBox\n\t\t\t\t\t\t\t\tvalue={project}\n\t\t\t\t\t\t\t\tonChange={handleProjectChange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t{project !== null && isApprover && model.resources.length > 0 && (\n\t\t\t\t\t\t\t<Grid container spacing={1} item xs={6} alignItems=\"flex-end\">\n\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\t\ttooltip=\"Cập nhật thay đổi\"\n\t\t\t\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\t\t\t\ttext=\"Commit\"\n\t\t\t\t\t\t\t\t\t\ticon=\"long-arrow-alt-up\"\n\t\t\t\t\t\t\t\t\t\tcolor=\"danger\"\n\t\t\t\t\t\t\t\t\t\tonClick={handleOpenForm}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Grid>\n\t\t\t\t</Grid>\n\t\t\t\t<TableContainer className={classes.container}>\n\t\t\t\t\t<Table stickyHeader aria-label=\"sticky table\" size=\"small\">\n\t\t\t\t\t\t<TableHead>\n\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t<TableCell align=\"left\" style={{ fontSize: '0.75rem' }}>Mã công tác</TableCell>\n\t\t\t\t\t\t\t\t<TableCell align=\"left\" style={{ fontSize: '0.75rem' }}>Diễn giải công tác</TableCell>\n\t\t\t\t\t\t\t\t<TableCell align=\"center\" style={{ fontSize: '0.75rem' }}>Đơn vị</TableCell>\n\t\t\t\t\t\t\t\t<TableCell align=\"left\" style={{ fontSize: '0.75rem' }}>Mã vật tư</TableCell>\n\t\t\t\t\t\t\t\t<TableCell align=\"left\" style={{ fontSize: '0.75rem' }}>Diễn giải vật tư</TableCell>\n\t\t\t\t\t\t\t\t<TableCell align=\"center\" style={{ fontSize: '0.75rem' }}>Đơn vị</TableCell>\n\t\t\t\t\t\t\t\t<TableCell align=\"right\" style={{ fontSize: '0.75rem' }}>Định mức</TableCell>\n\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t</TableHead>\n\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t{model.resources.map((r, index) => (\n\t\t\t\t\t\t\t\t<TableRow key={index} style={{ backgroundColor: getRowColor(r.status) }}>\n\t\t\t\t\t\t\t\t\t<TableCell align=\"left\" style={{ fontSize: '0.75rem' }}>\n\t\t\t\t\t\t\t\t\t\t<Grid container direction=\"column\">\n\t\t\t\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t\t\t\t{r.post !== null ? r.post.serviceMasterCode : '-'}\n\t\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t\t\t\t{r.pack !== null ? r.pack.serviceMasterCode : '-'}\n\t\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell align=\"left\" style={{ fontSize: '0.75rem' }}>\n\t\t\t\t\t\t\t\t\t\t<Grid container direction=\"column\">\n\t\t\t\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t\t\t\t{r.post !== null ? r.post.serviceMasterDescription : '-'}\n\t\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t\t\t\t{r.pack !== null ? r.pack.serviceMasterDescription : '-'}\n\t\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell align=\"center\" style={{ fontSize: '0.75rem' }}>\n\t\t\t\t\t\t\t\t\t\t<Grid container direction=\"column\">\n\t\t\t\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t\t\t\t{r.post !== null ? r.post.serviceMasterUnit : '-'}\n\t\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t\t\t\t{r.pack !== null ? r.pack.serviceMasterUnit : '-'}\n\t\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell align=\"left\" style={{ fontSize: '0.75rem' }}>\n\t\t\t\t\t\t\t\t\t\t<Grid container direction=\"column\">\n\t\t\t\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t\t\t\t{r.post !== null ? r.post.materialCode : '-'}\n\t\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t\t\t\t{r.pack !== null ? r.pack.materialCode : '-'}\n\t\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell align=\"left\" style={{ fontSize: '0.75rem' }}>\n\t\t\t\t\t\t\t\t\t\t<Grid container direction=\"column\">\n\t\t\t\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t\t\t\t{r.post !== null ? r.post.materialDescription : '-'}\n\t\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t\t\t\t{r.pack !== null ? r.pack.materialDescription : '-'}\n\t\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell align=\"center\" style={{ fontSize: '0.75rem' }}>\n\t\t\t\t\t\t\t\t\t\t<Grid container direction=\"column\">\n\t\t\t\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t\t\t\t{r.post !== null ? r.post.materialUnit : '-'}\n\t\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t\t\t\t{r.pack !== null ? r.pack.materialUnit : '-'}\n\t\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t<TableCell align=\"right\" style={{ fontSize: '0.75rem' }}>\n\t\t\t\t\t\t\t\t\t\t<Grid container direction=\"column\">\n\t\t\t\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t\t\t\t{r.post !== null ? format.formatMoney(r.post.quantity, 3) : '-'}\n\t\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t\t\t\t{r.pack !== null ? format.formatMoney(r.pack.quantity, 3) : '-'}\n\t\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t</Table>\n\t\t\t\t</TableContainer>\n\t\t\t</Paper>\n\t\t</>\n\t);\n}\n","import React from 'react';\n\nimport {\n  ComboBox,\n} from '@nvdunginest/emis-mui';\n\nimport materialService, {\n  MaterialModel,\n} from '../services/material';\n\ntype ComboBoxType = MaterialModel & {\n  label: string;\n}\n\ntype Props = {\n  value: MaterialModel | null;\n  onChange: (value: MaterialModel) => void;\n}\n\nconst MATERIAL_CODE_KEY = 'MATERIAL_CODE_KEY';\nconst MATERIAL_DESCRIPTION_KEY = 'MATERIAL_DESCRIPTION_KEY';\nconst MATERIAL_UNIT_KEY = 'MATERIAL_UNIT_KEY';\n\nconst renderComboBoxOptions = (serviceMasters: MaterialModel[]): ComboBoxType[] => {\n  return serviceMasters.map(x => {\n    const result: ComboBoxType = {\n      ...x,\n      label: `[${x.code}]-${x.description}`,\n    }\n\n    return result;\n  })\n}\n\nconst getCache = (): ComboBoxType | null => {\n  const code = localStorage.getItem(MATERIAL_CODE_KEY);\n  const description = localStorage.getItem(MATERIAL_DESCRIPTION_KEY);\n  const unit = localStorage.getItem(MATERIAL_UNIT_KEY);\n  if (code === null || description === null || unit === null) {\n    return null;\n  }\n  else {\n    return {\n      code: code,\n      label: `[${code}]-${description}`,\n      description: description,\n      unit: unit,\n    };\n  }\n}\n\nconst setCache = (material: ComboBoxType) => {\n  localStorage.setItem(MATERIAL_CODE_KEY, material.code);\n  localStorage.setItem(MATERIAL_DESCRIPTION_KEY, material.description);\n  localStorage.setItem(MATERIAL_UNIT_KEY, material.unit);\n}\n\nexport default function MaterialsComboBox({\n  value,\n  onChange,\n}: Props): JSX.Element {\n\n  const [data, setData] = React.useState<MaterialModel[]>([]);\n\n  const getData = async () => {\n    try {\n      setData(await materialService.getAll());\n    }\n    catch {\n      setData([]);\n    }\n  }\n\n  const handleChange = (value: ComboBoxType | null) => {\n    if (value !== null) {\n      onChange({\n        code: value.code,\n        description: value.description,\n        unit: value.unit,\n      });\n      setCache(value);\n    }\n  }\n\n  React.useEffect(() => {\n    const cache = getCache();\n    if (cache !== null) {\n      onChange({\n        code: cache.code,\n        description: cache.description,\n        unit: cache.unit,\n      });\n    }\n    getData();\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <ComboBox\n      required\n      label=\"Vật tư\"\n      options={renderComboBoxOptions(data)}\n      optionLabel=\"label\"\n      value={value !== null ? {\n        code: value.code,\n        label: `[${value.code}]-${value.description}`,\n        description: value.description,\n        unit: value.unit,\n      } : null}\n      getOptionSelected={(o, v) => o.code === v.code}\n      onChange={handleChange}\n    />\n  );\n}\n","import React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { makeStyles } from '@material-ui/core/styles';\nimport {\n\tPaper,\n\tTable,\n\tTableBody,\n\tTableCell,\n\tTableContainer,\n\tTableHead,\n\tTableRow,\n\tGrid,\n\tTypography,\n\tcolors,\n} from '@material-ui/core';\nimport {\n\tFormDialog,\n\tTextField,\n\tIconButton,\n\tUploadButton,\n\tDownloadButton,\n} from '@nvdunginest/emis-mui';\n\nimport {\n\tAppDispatch,\n\talertActions,\n\talertMessage,\n\tloadingActions,\n} from '../../../core';\n\nimport format from '../../../configs/format';\n\nimport ProjectsComboBox from '../components/ProjectsComboBox';\nimport MaterialsComboBox from '../components/MaterialsComboBox';\n\nimport {\n\tversionNumberEnum,\n\tAddFromExcelModel,\n} from '../services/common';\n\nimport {\n\tProjectModel,\n} from '../services/project';\n\nimport itemService, {\n\tItemViewModel,\n} from '../services/item';\n\nimport {\n\tMaterialModel,\n} from '../services/material';\n\nimport resourceService, {\n\tResourceViewModel,\n\tResourceModel,\n\tResourceRemoveModel,\n} from '../services/resource';\n\nconst useStyles = makeStyles({\n\troot: {\n\t\twidth: '100%',\n\t\theight: '100%',\n\t},\n\tcontainer: {\n\t\tmaxHeight: 'calc(100% - 130px)',\n\t\toverflowY: 'scroll',\n\t},\n\tcell: {\n\t\tfontSize: '0.75rem',\n\t},\n});\n\ntype ResourceState = {\n\tserviceMasterCode: string,\n\tmaterialCode: string,\n\tquantity: string,\n}\n\nconst initialState: ResourceState = {\n\tserviceMasterCode: '',\n\tmaterialCode: '',\n\tquantity: '',\n}\n\nconst isInclude = (serviceMasterCode: string, materialCode: string, data: ResourceRemoveModel[]): boolean => {\n\treturn data.find(x => x.materialCode === materialCode && x.serviceMasterCode === serviceMasterCode) !== undefined;\n}\n\nexport default function Resources(): JSX.Element {\n\tconst classes = useStyles();\n\n\tconst dispatch: AppDispatch = useDispatch();\n\tconst [showForm, setShowForm] = React.useState(false);\n\tconst [isEdit, setIsEdit] = React.useState(false);\n\n\tconst [project, setProject] = React.useState<ProjectModel | null>(null);\n\tconst [material, setMaterial] = React.useState<MaterialModel | null>(null);\n\n\tconst [items, setItems] = React.useState<ItemViewModel[]>([]);\n\tconst [resources, setResources] = React.useState<ResourceViewModel[]>([]);\n\tconst [model, setModel] = React.useState<ResourceState>(initialState);\n\n\tconst [selectedList, setSelectedList] = React.useState<ResourceRemoveModel[]>([]);\n\n\tconst [showAddExcelResult, setShowAddExcelResult] = React.useState(false);\n\tconst [addExcelResult, setAddExcelResult] = React.useState<AddFromExcelModel<ResourceModel>[]>([]);\n\n\tconst [keyWord, setKeyWord] = React.useState<string>('');\n\n\tconst [showConfirmDelete, setShowConfirmDelete] = React.useState(false);\n\n\tconst handleSubmitDelete = async () => {\n\t\tsetShowConfirmDelete(false);\n\t\tif (project !== null) {\n\t\t\tdispatch(loadingActions.show());\n\t\t\ttry {\n\t\t\t\tawait resourceService.remove(project.code, selectedList);\n\t\t\t\tfetchResources()\n\t\t\t\tsetSelectedList([]);\n\t\t\t\tdispatch(alertActions.show(alertMessage.ACTION_SUCCESS, 'success'));\n\t\t\t}\n\t\t\tcatch {\n\t\t\t\tdispatch(alertActions.show(alertMessage.ACTION_FAILURE, 'error'));\n\t\t\t\tdispatch(loadingActions.hide());\n\t\t\t}\n\t\t}\n\t}\n\n\tconst handleCloseExcelResult = () => {\n\t\tsetShowAddExcelResult(false);\n\t};\n\n\tconst handleSubmitUploadForm = async (files: File[]) => {\n\t\tif (files.length >= 1 && project !== null) {\n\t\t\tsetAddExcelResult([]);\n\t\t\tdispatch(loadingActions.show());\n\t\t\ttry {\n\t\t\t\tsetAddExcelResult(await resourceService.addFromExcel(project.code, files[0]));\n\t\t\t\thandleRefresh();\n\t\t\t\tsetShowAddExcelResult(true);\n\t\t\t}\n\t\t\tcatch {\n\t\t\t\tdispatch(loadingActions.hide());\n\t\t\t\tdispatch(alertActions.show(alertMessage.ACTION_FAILURE, 'error'));\n\t\t\t}\n\t\t}\n\t};\n\n\tconst fetchResources = async () => {\n\t\tif (project !== null) {\n\t\t\tdispatch(loadingActions.show());\n\t\t\ttry {\n\t\t\t\tsetResources(await resourceService.getAll(project.code, versionNumberEnum.PACK));\n\t\t\t}\n\t\t\tcatch {\n\t\t\t\tdispatch(alertActions.show(alertMessage.FETCH_FAILURE, 'error'));\n\t\t\t}\n\t\t\tfinally {\n\t\t\t\tdispatch(loadingActions.hide());\n\t\t\t}\n\t\t}\n\t}\n\n\tconst handleRefresh = async () => {\n\t\tif (project !== null) {\n\t\t\tdispatch(loadingActions.show());\n\t\t\ttry {\n\t\t\t\tconst data = await Promise.all([\n\t\t\t\t\titemService.getDistinct(project.code, versionNumberEnum.POST),\n\t\t\t\t\tresourceService.getAll(project.code, versionNumberEnum.PACK),\n\t\t\t\t]);\n\t\t\t\tsetItems(data[0]);\n\t\t\t\tsetResources(data[1]);\n\t\t\t}\n\t\t\tcatch {\n\t\t\t\tdispatch(alertActions.show(alertMessage.FETCH_FAILURE, 'error'));\n\t\t\t}\n\t\t\tfinally {\n\t\t\t\tdispatch(loadingActions.hide());\n\t\t\t}\n\t\t}\n\t}\n\n\tconst handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n\t\tsetModel({ ...model, [event.target.name]: event.target.value });\n\t};\n\n\tconst handleCloseForm = () => {\n\t\tsetShowForm(false);\n\t};\n\n\tconst handleOpenCreateForm = (serviceMasterCode: string) => {\n\t\tsetModel({\n\t\t\tserviceMasterCode: serviceMasterCode,\n\t\t\tmaterialCode: '',\n\t\t\tquantity: '0',\n\t\t});\n\t\tsetIsEdit(false);\n\t\tsetShowForm(true);\n\t};\n\n\tconst handleOpenEditForm = (item: ResourceViewModel) => {\n\t\tsetModel({\n\t\t\tserviceMasterCode: item.serviceMasterCode,\n\t\t\tmaterialCode: item.materialCode,\n\t\t\tquantity: item.quantity.toString(),\n\t\t});\n\t\tsetIsEdit(true);\n\t\tsetShowForm(true);\n\t};\n\n\tconst handleSubmit = async () => {\n\t\tsetShowForm(false);\n\t\tif (project !== null) {\n\t\t\tdispatch(loadingActions.show());\n\t\t\ttry {\n\t\t\t\tif (isEdit) {\n\t\t\t\t\tconst data: ResourceModel = {\n\t\t\t\t\t\tserviceMasterCode: model.serviceMasterCode,\n\t\t\t\t\t\tmaterialCode: model.materialCode,\n\t\t\t\t\t\tquantity: parseFloat(model.quantity),\n\t\t\t\t\t\tprojectCode: project.code,\n\t\t\t\t\t\tversionNumber: versionNumberEnum.PACK,\n\t\t\t\t\t}\n\t\t\t\t\tawait resourceService.edit(project.code, model.serviceMasterCode, model.materialCode, data);\n\t\t\t\t\tdispatch(alertActions.show(alertMessage.ACTION_SUCCESS, 'success'));\n\t\t\t\t\tfetchResources();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (material !== null) {\n\t\t\t\t\t\tconst data: ResourceModel = {\n\t\t\t\t\t\t\tserviceMasterCode: model.serviceMasterCode,\n\t\t\t\t\t\t\tmaterialCode: material.code,\n\t\t\t\t\t\t\tquantity: parseFloat(model.quantity),\n\t\t\t\t\t\t\tprojectCode: project.code,\n\t\t\t\t\t\t\tversionNumber: versionNumberEnum.PACK,\n\t\t\t\t\t\t}\n\t\t\t\t\t\tawait resourceService.create(project.code, data);\n\t\t\t\t\t\tdispatch(alertActions.show(alertMessage.ACTION_SUCCESS, 'success'));\n\t\t\t\t\t\tfetchResources();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch {\n\t\t\t\tdispatch(alertActions.show(alertMessage.ACTION_FAILURE, 'error'));\n\t\t\t\tdispatch(loadingActions.hide());\n\t\t\t}\n\t\t}\n\t};\n\n\tconst handleSelect = async (serviceMasterCode: string, materialCode: string) => {\n\t\tif (isInclude(serviceMasterCode, materialCode, selectedList)) {\n\t\t\tsetSelectedList(selectedList.filter(x => !(x.materialCode === materialCode && x.serviceMasterCode === serviceMasterCode)));\n\t\t}\n\t\telse {\n\t\t\tsetSelectedList([...selectedList, { materialCode, serviceMasterCode }]);\n\t\t}\n\t}\n\n\tReact.useEffect(() => {\n\t\thandleRefresh();\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [project]);\n\n\tReact.useEffect(() => {\n\t\tsetSelectedList([]);\n\t}, [resources]);\n\n\treturn (\n\t\t<>\n\t\t\t<FormDialog\n\t\t\t\topen={showConfirmDelete}\n\t\t\t\tonClose={() => { setShowConfirmDelete(false) }}\n\t\t\t\tonSubmit={() => { handleSubmitDelete(); }}\n\t\t\t\ttitle=\"Xác nhận xóa các định mức\"\n\t\t\t>\n\t\t\t\t<Grid container spacing={1}>\n\t\t\t\t\t<Grid item xs={12}>\n\t\t\t\t\t\t<Typography variant=\"body2\">\n\t\t\t\t\t\t\tThao tác này sẽ xóa các định mức được chọn. Vui lòng kiểm tra kỹ trước khi xóa!\n\t\t\t\t\t\t</Typography>\n\t\t\t\t\t</Grid>\n\t\t\t\t\t{selectedList.map((s, i) => (\n\t\t\t\t\t\t<Grid item xs={12} key={i}>\n\t\t\t\t\t\t\t<Typography variant=\"subtitle2\">{`${s.serviceMasterCode} - ${s.materialCode}`}</Typography>\n\t\t\t\t\t\t</Grid>\n\t\t\t\t\t))}\n\t\t\t\t</Grid>\n\t\t\t</FormDialog>\n\t\t\t<FormDialog\n\t\t\t\topen={showAddExcelResult}\n\t\t\t\tonClose={handleCloseExcelResult}\n\t\t\t\ttitle=\"Kết quả tạo từ file excel\"\n\t\t\t>\n\t\t\t\t<Grid container spacing={1}>\n\t\t\t\t\t{addExcelResult.map((a, index) => (\n\t\t\t\t\t\t<Grid item container spacing={1} xs={12} key={index}>\n\t\t\t\t\t\t\t<Grid item xs={12} md={3} style={{ color: a.isAdded ? 'green' : 'red' }}>\n\t\t\t\t\t\t\t\t<Typography variant=\"subtitle2\">{`${a.item.serviceMasterCode}-${a.item.materialCode}`}</Typography>\n\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t<Grid item xs={12} md={9} style={{ color: a.isAdded ? 'green' : 'red' }}>\n\t\t\t\t\t\t\t\t<Typography variant=\"caption\">{a.message}</Typography>\n\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t</Grid>\n\t\t\t\t\t))}\n\t\t\t\t</Grid>\n\t\t\t</FormDialog>\n\t\t\t<FormDialog\n\t\t\t\ttitle=\"Thêm/Chỉnh sửa\"\n\t\t\t\topen={showForm}\n\t\t\t\tonClose={handleCloseForm}\n\t\t\t\tonSubmit={handleSubmit}\n\t\t\t>\n\t\t\t\t<Grid container spacing={1}>\n\t\t\t\t\t<Grid item xs={12}>\n\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\tname=\"serviceMasterCode\"\n\t\t\t\t\t\t\tlabel=\"Mã công tác\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\tdisabled\n\t\t\t\t\t\t\tvalue={model.serviceMasterCode}\n\t\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Grid>\n\t\t\t\t\t<Grid item xs={12}>\n\t\t\t\t\t\t{isEdit ?\n\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\tname=\"materialCode\"\n\t\t\t\t\t\t\t\tlabel=\"Mã vật tư\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\tdisabled\n\t\t\t\t\t\t\t\tvalue={model.materialCode}\n\t\t\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t<MaterialsComboBox\n\t\t\t\t\t\t\t\tvalue={material}\n\t\t\t\t\t\t\t\tonChange={(value) => { setMaterial(value) }}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t}\n\t\t\t\t\t</Grid>\n\t\t\t\t\t<Grid item xs={12}>\n\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\tname=\"quantity\"\n\t\t\t\t\t\t\tlabel=\"Số lượng\"\n\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\tvalue={model.quantity}\n\t\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Grid>\n\t\t\t\t</Grid>\n\t\t\t</FormDialog>\n\t\t\t<Paper className={classes.root}>\n\t\t\t\t<Grid container>\n\t\t\t\t\t<Grid\n\t\t\t\t\t\tcontainer\n\t\t\t\t\t\titem xs={12}\n\t\t\t\t\t\tstyle={{ padding: '8px' }}\n\t\t\t\t\t\tdirection=\"row\"\n\t\t\t\t\t\tspacing={1}\n\t\t\t\t\t\talignItems=\"flex-end\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Grid item xs={12} md={6}>\n\t\t\t\t\t\t\t<ProjectsComboBox\n\t\t\t\t\t\t\t\tvalue={project}\n\t\t\t\t\t\t\t\tonChange={(value) => { setProject(value) }}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t<Grid item xs={12} md={6}>\n\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\tname=\"keyWord\"\n\t\t\t\t\t\t\t\tlabel=\"Lọc theo công tác\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tvalue={keyWord}\n\t\t\t\t\t\t\t\tonChange={(event) => { setKeyWord(event.target.value); }}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t{project !== null && (\n\t\t\t\t\t\t\t<Grid container spacing={1} item xs={12} alignItems=\"flex-end\">\n\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t<UploadButton\n\t\t\t\t\t\t\t\t\t\tfilesLimit={1}\n\t\t\t\t\t\t\t\t\t\ttitle=\"Tải tệp excel\"\n\t\t\t\t\t\t\t\t\t\tacceptedFiles={['.xls', '.xlsx',]}\n\t\t\t\t\t\t\t\t\t\tonSubmit={handleSubmitUploadForm}\n\t\t\t\t\t\t\t\t\t\ttooltip=\"Tạo từ file excel\"\n\t\t\t\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\t\t\t\ttext=\"Excel\"\n\t\t\t\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t<DownloadButton\n\t\t\t\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\t\t\t\tlabel=\"Tải về\"\n\t\t\t\t\t\t\t\t\t\tfilename={`${project.code}_Dinh muc.xlsx`}\n\t\t\t\t\t\t\t\t\t\turl={`/api/project-system/resources/get-excel?projectCode=${project.code}&version=${versionNumberEnum.PACK}`}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\t\ttooltip=\"Làm mới\"\n\t\t\t\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\t\t\t\ttext=\"Làm mới\"\n\t\t\t\t\t\t\t\t\t\tcolor=\"success\"\n\t\t\t\t\t\t\t\t\t\ticon=\"sync-alt\"\n\t\t\t\t\t\t\t\t\t\tonClick={handleRefresh}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\t\ttooltip=\"Xóa các định mức đã chọn\"\n\t\t\t\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\t\t\t\ttext=\"Xóa\"\n\t\t\t\t\t\t\t\t\t\tcolor=\"danger\"\n\t\t\t\t\t\t\t\t\t\ticon=\"trash-alt\"\n\t\t\t\t\t\t\t\t\t\tdisabled={selectedList.length <= 0}\n\t\t\t\t\t\t\t\t\t\tonClick={() => { setShowConfirmDelete(true); }}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Grid>\n\t\t\t\t</Grid>\n\t\t\t\t<TableContainer className={classes.container}>\n\t\t\t\t\t<Table stickyHeader aria-label=\"sticky table\" size=\"small\">\n\t\t\t\t\t\t<TableHead>\n\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t<TableCell style={{ padding: 0, width: 16 }}></TableCell>\n\t\t\t\t\t\t\t\t<TableCell className={classes.cell} align=\"left\">Mã vật tư</TableCell>\n\t\t\t\t\t\t\t\t<TableCell className={classes.cell} align=\"left\">Diễn giải</TableCell>\n\t\t\t\t\t\t\t\t<TableCell className={classes.cell} align=\"center\">Đơn vị</TableCell>\n\t\t\t\t\t\t\t\t<TableCell className={classes.cell} align=\"right\">Định mức</TableCell>\n\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t</TableHead>\n\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t{items.map(item => (\n\t\t\t\t\t\t\t\t<React.Fragment key={item.serviceMasterCode}>\n\t\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t\t<TableCell style={{ padding: 0, width: 16 }}></TableCell>\n\t\t\t\t\t\t\t\t\t\t<TableCell className={classes.cell} align=\"left\" style={{ fontWeight: 'bold' }}>{item.serviceMasterCode}</TableCell>\n\t\t\t\t\t\t\t\t\t\t<TableCell className={classes.cell} align=\"left\" style={{ fontWeight: 'bold' }}>{item.serviceMasterDescription}</TableCell>\n\t\t\t\t\t\t\t\t\t\t<TableCell className={classes.cell} align=\"center\" style={{ fontWeight: 'bold' }}>{item.serviceMasterUnit}</TableCell>\n\t\t\t\t\t\t\t\t\t\t<TableCell className={classes.cell} align=\"right\"></TableCell>\n\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t{resources.filter(x => x.serviceMasterCode === item.serviceMasterCode).map((r, index) => (\n\t\t\t\t\t\t\t\t\t\t<TableRow key={index}\n\t\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: isInclude(r.serviceMasterCode, r.materialCode, selectedList) ? colors.red[100] : 'initial',\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\t\t\t\t\t\t\t\twidth: 16,\n\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: isInclude(r.serviceMasterCode, r.materialCode, selectedList) ? colors.red[500] : colors.teal[100],\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => { handleSelect(r.serviceMasterCode, r.materialCode) }}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\t\t\t\t\talign=\"left\"\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ paddingLeft: '32px', cursor: 'pointer', }}\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\thandleOpenEditForm(r);\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t{r.materialCode}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className={classes.cell} align=\"left\" style={{ paddingLeft: '32px' }}>{r.materialDescription}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className={classes.cell} align=\"center\">{r.materialUnit}</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className={classes.cell} align=\"right\">{format.formatMoney(r.quantity, 3)}</TableCell>\n\t\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t\t<TableCell style={{ padding: 0, width: 16, backgroundColor: colors.green[300] }}></TableCell>\n\t\t\t\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\t\t\t\tclassName={classes.cell}\n\t\t\t\t\t\t\t\t\t\t\tcolSpan={4}\n\t\t\t\t\t\t\t\t\t\t\talign=\"left\"\n\t\t\t\t\t\t\t\t\t\t\tstyle={{ cursor: 'pointer', fontStyle: 'italic' }}\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleOpenCreateForm(item.serviceMasterCode)}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t+ Thêm định mức mới\n\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t</React.Fragment>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t</Table>\n\t\t\t\t</TableContainer>\n\t\t\t</Paper>\n\t\t</>\n\t);\n}\n","import React from 'react';\nimport {\n  Switch,\n  Route,\n  useRouteMatch,\n} from 'react-router-dom';\n\nimport CbsReport from '../pages/CbsReport';\nimport EstimatorCommits from '../pages/EstimatorCommits';\nimport Resources from '../pages/Resources';\n\nexport default function EstimatorRoutes(): JSX.Element {\n  const { path } = useRouteMatch();\n\n  return (\n    <Switch>\n      <Route path={`${path}/resources`} component={Resources} />\n      <Route path={`${path}/commits`} component={EstimatorCommits} />\n      <Route path={`${path}/cbs-report`} component={CbsReport} />\n    </Switch>\n  );\n}\n"],"sourceRoot":""}